/* v40 (base v39 + dynamic pricing enhancements) */
/* --- existing v39 CSS remains unchanged above this line --- */

/* ===== Dynamic Pricing Additions (v40) ===== */
.pricing-dynamic { background:var(--color-bg-alt); }
html[data-theme="dark"] .pricing-dynamic { background:#181818; }
.pricing-dynamic .small-max { max-width:720px; }

.billing-toggle-wrap {
  margin:var(--space-8) auto var(--space-6);
  display:inline-flex;
  position:relative;
  background:var(--color-bg-soft);
  border:1px solid var(--color-border);
  border-radius:14px;
  overflow:hidden;
  box-shadow:var(--shadow-xs);
}
.billing-toggle {
  position:relative;
  background:transparent;
  border:0;
  font:inherit;
  font-weight:600;
  padding:.85rem 1.6rem;
  cursor:pointer;
  color:var(--color-text);
  transition:color .35s;
  display:flex;
  align-items:center;
  gap:.55rem;
}
.billing-toggle[aria-pressed="true"] { color:#fff; }
.billing-toggle .save-pill {
  background:var(--color-primary);
  color:#fff;
  font-size:.55rem;
  padding:.25rem .45rem;
  border-radius:10px;
  letter-spacing:.05em;
  text-transform:uppercase;
  font-weight:600;
}
.bt-focus-ring {
  position:absolute;
  inset:0;
  pointer-events:none;
  border-radius:inherit;
}
.billing-toggle-wrap:focus-within .bt-focus-ring {
  box-shadow:0 0 0 3px rgba(227,179,47,.55);
}

.billing-toggle-wrap::before {
  content:"";
  position:absolute;
  top:3px;
  bottom:3px;
  left:3px;
  width:calc(50% - 6px);
  background:linear-gradient(135deg,var(--color-primary),var(--color-secondary));
  border-radius:11px;
  transition:transform .5s cubic-bezier(.65,.05,.36,1);
}
.billing-toggle-wrap[data-cycle="annual"]::before {
  transform:translateX(100%);
}

.billing-note { margin-top:.5rem; min-height:1.2rem; }

.pricing-plans {
  margin:var(--space-12) auto 0;
  display:grid;
  gap:var(--space-7);
  grid-template-columns:repeat(auto-fit,minmax(260px,1fr));
  max-width:1150px;
  position:relative;
}

.plan-card {
  position:relative;
  background:var(--color-bg-soft);
  border:1px solid var(--color-border);
  border-radius:20px;
  padding:var(--space-7) var(--space-6) var(--space-7);
  display:flex;
  flex-direction:column;
  gap:var(--space-5);
  box-shadow:var(--shadow-xs);
  transition:transform .4s, box-shadow .4s, border-color .4s, background .4s;
  overflow:hidden;
}
.plan-card:hover {
  transform:translateY(-6px);
  box-shadow:var(--shadow);
  border-color:var(--color-primary);
}
.plan-card.popular {
  border:2px solid var(--color-primary);
  animation:popGlow 5.5s ease-in-out infinite;
  background:
    linear-gradient(135deg,rgba(255,255,255,.9),rgba(255,255,255,.75));
}
html[data-theme="dark"] .plan-card.popular {
  background:linear-gradient(135deg,rgba(30,30,30,.95),rgba(40,40,40,.75));
}
.plan-card.popular::after {
  content:"";
  position:absolute;
  inset:-2px;
  padding:2px;
  background:linear-gradient(140deg,var(--color-primary),var(--color-secondary),var(--color-accent),var(--color-primary));
  background-size:300% 300%;
  border-radius:inherit;
  -webkit-mask:
    linear-gradient(#000 0 0) content-box,
    linear-gradient(#000 0 0);
  -webkit-mask-composite:xor;
  mask-composite:exclude;
  animation:borderFlow 10s linear infinite;
  pointer-events:none;
  opacity:.7;
}

.plan-badge {
  position:absolute;
  top:-12px;
  left:var(--space-6);
  background:var(--color-primary);
  color:#fff;
  font-size:.6rem;
  letter-spacing:.08em;
  font-weight:600;
  padding:.4rem .6rem;
  border-radius:8px;
  text-transform:uppercase;
  box-shadow:0 4px 14px -4px rgba(0,0,0,.4);
}

.plan-head h3 {
  margin:0;
  font-size:1.05rem;
  font-weight:600;
  letter-spacing:.01em;
}

.plan-price-line {
  margin:.15rem 0 0;
  font-size:.9rem;
  font-weight:500;
  color:var(--color-text);
  display:flex;
  align-items:baseline;
  gap:.25rem;
  flex-wrap:wrap;
}
.plan-price-line .amt {
  font-size:1.38rem;
  font-weight:700;
  letter-spacing:-.01em;
}
.plan-price-line .per {
  font-size:.68rem;
  letter-spacing:.08em;
  text-transform:uppercase;
  font-weight:600;
}
.plan-price-line .savings {
  font-size:.6rem;
  background:var(--color-accent);
  color:#2E2E2E;
  padding:.25rem .45rem;
  border-radius:8px;
  letter-spacing:.06em;
  text-transform:uppercase;
  font-weight:600;
}

.plan-features {
  list-style:disc;
  margin:0;
  padding:0 0 0 1.1rem;
  display:flex;
  flex-direction:column;
  gap:.4rem;
  font-size:.78rem;
  line-height:1.5;
}
.plan-cta { margin-top:auto; }
.plan-cta .btn.full { width:100%; text-align:center; }

html[data-theme="dark"] .plan-card { background:#1E1E1E; }
html[data-theme="dark"] .plan-card:hover { background:#242424; }

/* Add-Ons */
.addons-section { margin-top:var(--space-16); }
.addons-heading { margin-bottom:var(--space-8); }
.addons-grid {
  display:grid;
  gap:var(--space-6);
  grid-template-columns:repeat(auto-fit,minmax(240px,1fr));
  max-width:1150px;
  margin:0 auto;
}
.addon-card {
  background:var(--color-bg-soft);
  border:1px solid var(--color-border);
  border-radius:16px;
  padding:var(--space-6) var(--space-5);
  display:flex;
  flex-direction:column;
  gap:.6rem;
  box-shadow:var(--shadow-xs);
  transition:transform .35s, box-shadow .35s, border-color .35s;
}
.addon-card:hover {
  transform:translateY(-4px);
  box-shadow:var(--shadow);
  border-color:var(--color-primary);
}
.addon-head {
  display:flex;
  align-items:baseline;
  justify-content:space-between;
  gap:1rem;
}
.addon-name {
  margin:0;
  font-size:.92rem;
  font-weight:600;
  letter-spacing:.01em;
}
.addon-price {
  font-size:.65rem;
  font-weight:600;
  letter-spacing:.07em;
  text-transform:uppercase;
  background:var(--color-accent-alt-soft);
  color:#332600;
  padding:.35rem .55rem;
  border-radius:8px;
}
html[data-theme="dark"] .addon-price {
  background:#332600;
  color:#FFC247;
}
.addon-desc {
  margin:0;
  font-size:.72rem;
  line-height:1.45;
  color:var(--color-muted);
}

/* Loading states */
.loading-spinner {
  width:46px;
  height:46px;
  border:4px solid var(--color-border);
  border-top-color:var(--color-primary);
  border-radius:50%;
  animation:spin 1s linear infinite;
  margin:1.5rem auto .75rem;
}
.loading-spinner.sm { width:34px; height:34px; border-width:3px; }
.loading-text { text-align:center; color:var(--color-muted); font-size:.7rem; letter-spacing:.06em; }

/* Animations */
@keyframes spin {
  to { transform:rotate(360deg); }
}
@keyframes popGlow {
  0%,100% { box-shadow:0 10px 28px -12px rgba(0,0,0,.4),0 0 0 0 rgba(44,160,28,.0); }
  50% { box-shadow:0 14px 40px -14px rgba(0,0,0,.55),0 0 0 6px rgba(44,160,28,.18); }
}
@keyframes borderFlow {
  0% { background-position:0% 50%; }
  50% { background-position:100% 50%; }
  100% { background-position:0% 50%; }
}

@media (max-width:640px){
  .billing-toggle { padding:.75rem 1.1rem; }
  .plan-features { font-size:.74rem; }
  .addons-grid { grid-template-columns:repeat(auto-fit,minmax(200px,1fr)); }
}

@media (prefers-reduced-motion:reduce){
  .plan-card.popular,
  .plan-card.popular::after,
  .billing-toggle-wrap::before {
    animation:none!important;
  }
}

/* End dynamic pricing additions */
